{"version":3,"sources":["webpack:///webpack/bootstrap 3b97870414c163957e93","webpack:///./src/gameloop/Exceptions.js","webpack:///./src/gameloop/base/sprites/Sprite.js","webpack:///./src/gameloop/base/sprites/AnimatedSprite.js","webpack:///./src/gameloop/base/Frame.js","webpack:///./src/gameloop/base/RegistryItem.js","webpack:///./src/gameloop/base/audio/AudioUnit.js","webpack:///./src/gameloop/Constants.js","webpack:///./src/gameloop/components/sample/Bullet.js","webpack:///./src/gameloop.js","webpack:///./src/gameloop/GameLoop.js","webpack:///./src/gameloop/util/OnReady.js","webpack:///./src/gameloop/components/Clear.js","webpack:///./src/gameloop/components/sample/StarField.js","webpack:///./src/gameloop/base/Manager.js","webpack:///./src/gameloop/base/audio/GLAudio.js","webpack:///./src/gameloop/base/audio/SoundTrack.js","webpack:///./src/gameloop/components/sample/Shooter.js","webpack:///./src/gameloop/base/input/Keyboard.js","webpack:///./src/gameloop/base/input/Mouse.js","webpack:///./src/logo.js"],"names":["GameException","message","name","Sprite","img","imageElement","offset","x","y","position","rotation","Math","PI","width","height","setImageElement","key","asset","manager","getAsset","sprite","dataset","hasOwnProperty","obj","val","r","imageId","document","addEventListener","getElementById","context","p","getPosition","getOffsetPixels","save","translate","rotate","getRotation","drawImage","getImageElement","getWidth","getHeight","restore","AnimatedSprite","frames","frame","push","forEach","f","data","origin","size","setFrames","JSON","parse","atob","glFrames","getFrame","draw","Frame","stringify","RegistryItem","state","loading","addOnLoad","itemLoad","awaiting","callback","call","AudioUnit","glaudio","node","gain","type","AudioNode","currentVolume","playing","connect","value","music","sounds","vol","max","min","t","at","setValueAtTime","exponentialRampToValueAtTime","toLowerCase","setVolume","MIN_VOLUME","MAX_VOLUME","Bullet","active","velocity","console","log","window","Clear","StarField","GLAudio","SoundTrack","Shooter","GameLoop","Keyboard","Mouse","Gamepad","navigator","Touch","canvas","ctx","initialized","drawContext","initEvents","prevUpdate","prevDraw","updateables","drawables","targetRate","w","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","setTimeOut","getContext","_resizeCanvas","bind","_loop","_fireInitEvents","objectable","addDrawable","update","addUpdateable","updateable","length","drawable","item","object","i","splice","timestamp","_update","_draw","timeDiff","event","innerWidth","innerHeight","onReady","cb","readyState","arguments","prevORSC","onreadystatechange","color","setTransform","clearRect","fillStyle","fillRect","center","bounds","particles","particleCount","clearing","spawnRadius","particle","random","Manager","registry","assets","components","querySelectorAll","addAsset","glAsset","timediff","component","AudioContext","master","createGain","destination","currentTime","options","unit","set","result","createOscillator","_makeUnit","start","newMedia","media","cloneNode","createMediaElementSource","makeUnit","on","play","off","pause","create","createBufferSource","buffer","progress","startTime","onend","stop","newnode","onended","nowPlaying","activeUnit","track","title","PERIOD","speed","input","getX","getY","isShooting","shotPeriod","bulletList","shotTimer","bullet","readyLoadImageId","updatePosition","updateBullets","v","isActive","next","getNextBullet","shoot","receiver","keys","keyProperty","isPushed","isKeyDown","keyEventAnalyze","e","backups","shift","removeEventListener","UIRegion","h","prototype","contains","o","Input","_inputs","mouse","GLInput","keyboard","gamepad","touch","axes","buttons","prevButtons","currButtons","UIList","currUI","prevUI","getPointer","setUI","id","region","removeUI","setAxisId","typeid","typeid2","id2","setButtonId","getAxis","frompos","isTracking","dir","coord","other","unnormal","unsign","otherUnnormal","othersign","sqrt","keyPos","keyNeg","isButtonDown","newButtonPush","isUIOver","isUIPush","b","anyPress","anyKey","anyButton","anyTouch","has","exists","getButtons","butt","getUI","getIsWithinUI","hasViewport","setViewPort","GameInput","getInput","nullInput","MenuInput","menuMoveTime","canMove","menuMove","time","menuThreshold","menuDelay","_up","_down","_select","constructor","menuUpdate","menuupdown","menuDown","menuUp","menuSelect","menuClick","menuBack","vp_pixel_ratio_x","vp_pixel_ratio_y","viewport","tracking","up","down","mouseAnalyze","getOffset","bcr","target","getBoundingClientRect","clientX","left","clientY","top","offsetX","offsetY","which","click","over","out","move","unwireEvents","clientWidth","clientHeight","wireEvents","button","logo"],"mappings":"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","file":"gameloop.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3b97870414c163957e93","export function GameException(message) {\n  this.message = message;\n  this.name = \"GameException\";\n}\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/Exceptions.js","/* global manager */\n\nimport { GameException } from \"../../Exceptions\";\nimport AnimatedSprite from \"./AnimatedSprite\";\n\nexport default class Sprite {\n\n  constructor (img) {\n    this.imageElement = null;\n    this.offset = {\n      x: 0.5,\n      y: 0.5\n    };\n    this.position = {\n      x: 0,\n      y: 0\n    };\n    this.rotation = Math.PI;\n    this.width = null;\n    this.height = null;\n\n    if (img && (img !== null)){\n      this.setImageElement(img);\n    }\n  }\n\n  /**\n   * fromAsset\n   *\n   * @param key\n   * @returns {*}\n   */\n  fromAsset (key) {\n    const asset = manager.getAsset(key);\n    let sprite = null;\n    if (asset.dataset.hasOwnProperty(\"glFrames\")){\n      sprite = new AnimatedSprite();\n    } else {\n      sprite = new Sprite();\n    }\n    sprite.setImageElement(manager.getAsset(key));\n    return sprite;\n  }\n\n  /**\n   * getOffset\n   *\n   * @returns {*}\n   */\n  getOffset () {\n    return this.offset;\n  }\n\n  /**\n   *\n   * @param offset\n   */\n  setOffset (offset) {\n    if (typeof(offset.x) !== \"undefined\" && typeof(offset.y) !== \"undefined\") {\n      this.offset = offset;\n    } else {\n      throw new GameException(\"Invalid offset,\", offset);\n    }\n  }\n\n  /**\n   * getPosition\n   *\n   * @returns {*|position|{x, y}}\n   */\n  getPosition () {\n    return this.position;\n  }\n\n  /**\n   * setPosition\n   *\n   * @param obj\n   */\n  setPosition (obj) {\n    if (typeof(obj.x) !== \"undefined\" && typeof(obj.y) !== \"undefined\"){\n      this.position = obj;\n    } else {\n      throw new GameException(\"Invalid position settings\");\n    }\n  }\n\n  /**\n   * getImageElement\n   *\n   * @returns {null|*}\n   */\n  getImageElement () {\n    return this.imageElement;\n  }\n\n  /**\n   * setImageElement\n   *\n   * @param val\n   */\n  setImageElement (val) {\n    this.imageElement = val;\n    this.width = val.width;\n    this.height = val.height;\n  }\n\n  /**\n   * getOffsetPixels\n   *\n   * @returns {{x: number, y: number}}\n   */\n  getOffsetPixels () {\n    return {\n      x: -1 * this.offset.x * this.width,\n      y: -1 * this.offset.y * this.height\n    };\n  }\n\n  /**\n   * getRotation\n   *\n   * @returns {*}\n   */\n  getRotation () {\n    return this.rotation;\n  }\n\n  /**\n   * setRotation\n   *\n   * @param r\n   */\n  setRotation (r) {\n    this.rotation = r;\n  }\n\n  /**\n   * readyLoadImageId\n   *\n   * @param imageId\n   */\n  readyLoadImageId (imageId) {\n    document.addEventListener(\"readystatechange\", () => {\n      this.setImageElement(document.getElementById(imageId));\n    });\n  }\n\n\n  /**\n   * draw\n   *\n   * @param context\n   */\n  draw (context) {\n    const p = this.getPosition();\n    const offset = this.getOffsetPixels();\n\n    context.save();\n    context.translate(p.x, p.y);\n    context.rotate(this.getRotation());\n\n    context.drawImage(\n      this.getImageElement(),\n      offset.x,\n      offset.y,\n      this.getWidth(),\n      this.getHeight()\n    );\n\n    context.restore();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/sprites/Sprite.js","import Frame from \"../Frame\";\nimport Sprite from \"./Sprite\";\n\nexport default class AnimatedSprite extends Sprite {\n\n  constructor () {\n    super();\n\n    this.frames = [];\n    const frame = new Frame();\n    frame.img = this.getImageElement();\n    this.frames.push(frame);\n    this.frame = 0;\n  }\n\n  /**\n   * setFrames\n   *\n   * @param frames\n   */\n  setFrames (frames) {\n    if (frames.hasOwnProperty(\"length\")) {\n      this.frames = [];\n\n      frames.forEach((f) => {\n        this.frames.push(( (data) => {\n          const frame = new Frame();\n          frame.origin = {x: data[0], y: data[1]};\n          frame.offset = {x: data[2], y: data[3]};\n          frame.size = {x: data[4], y: data[5]};\n          return frame;\n        })(f));\n      });\n    }\n  }\n\n  /**\n   * setImageElement\n   *\n   * @param img\n   */\n  setImageElement (img) {\n    super.setImageElement(img);\n    if (img.dataset.hasOwnProperty(\"glFrames\"))  {\n      this.setFrames(JSON.parse(atob(img.dataset.glFrames)));\n    }\n    else {\n      this.setFrames([[\n        0, 0,\n        -1/2 * this.getWidth(), -1/2 * this.getHeight(),\n        this.getWidth(), this.getHeight()\n      ]]);\n    }\n    this.frame = 0;\n  }\n\n  /**\n   * getFrame\n   *\n   * @returns {*}\n   */\n  getFrame () {\n    return this.frames[this.frame];\n  }\n\n  /**\n   * draw\n   *\n   * @param context\n   */\n  draw (context) {\n    const p = this.getPosition();\n\n    context.save();\n    context.translate(p.x, p.y);\n    context.rotate(this.getRotation());\n    this.getFrame().draw(context, this.getImageElement());\n    context.restore();\n  }\n\n  /**\n   * getOffsetPixels\n   *\n   * @returns {*}\n   */\n  getOffsetPixels () {\n    return this.getFrame().offset;\n  }\n\n  /**\n   * getWidth\n   *\n   * @returns {*|number}\n   */\n  getWidth () {\n    return this.getFrame().size.x;\n  }\n\n  /**\n   * getHeight\n   *\n   * @returns {*|number}\n   */\n  getHeight () {\n    return this.getFrame().size.y;\n  }\n}\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/sprites/AnimatedSprite.js","export default class Frame {\n\n  constructor() {\n    this.origin = {\n      x: 0,\n      y: 0\n    };\n    this.offset = {\n      x: -24,\n      y: -24\n    };\n    this.size = {\n      x: 48,\n      y: 48\n    };\n  }\n\n  /**\n   * draw\n   *\n   * @param context\n   * @param img\n   */\n  draw (context, img) {\n    if (img === null){\n      return;\n    }\n\n    context.drawImage(\n      img,\n      this.origin.x,\n      this.origin.y,\n      this.size.x,\n      this.size.y,\n      this.offset.x,\n      this.offset.y,\n      this.size.x,\n      this.size.y\n    );\n  }\n\n  /**\n   * toJSON\n   */\n  toJSON () {\n    return JSON.stringify([\n      this.origin.x, this.origin.y,\n      this.offset.x, this.offset.y,\n      this.size.x, this.size.y\n    ]);\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/Frame.js","export default class RegistryItem {\n  constructor (key, obj) {\n    this.key = key;\n    this.obj = obj;\n    this.state = \"ready\";\n    if (obj.loading && (typeof(obj.addOnLoad) === \"function\")) {\n      this.state = \"loading\";\n      obj.addOnLoad(this.itemLoad(), this);\n    }\n  }\n\n  itemLoad (awaiting) {\n    if (awaiting.hasOwnProperty(this.key)){\n      awaiting[this.key].callback.call(awaiting[this.key].context, this.obj);\n      delete awaiting[this.key];\n    }\n    this.state = \"ready\";\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/RegistryItem.js","import { MIN_VOLUME, MAX_VOLUME } from \"../../Constants\";\nimport { GameException } from \"../../Exceptions\";\n\nexport default class AudioUnit {\n  constructor (glaudio, node, gain, type) {\n    if (!(node instanceof AudioNode) || !(gain instanceof AudioNode)) {\n      throw new GameException(\"Invalid arguments, AudioNodes required.\");\n    }\n\n    this.currentVolume = 0.3;\n    this.playing = false;\n    this.node = node;\n    this.gain = gain;\n\n    this.glaudio = glaudio;\n\n    this.node.connect(gain);\n    this.gain.gain.value = MIN_VOLUME;\n\n    if (type === \"music\") {\n      this.gain.connect(this.glaudio.music);\n    } else {\n      this.gain.connect(this.glaudio.sounds);\n    }\n  }\n\n  setVolume (vol, save) {\n    if (typeof(save) === \"undefined\"){\n      save = true;\n    }\n\n    vol = Math.max(vol, MIN_VOLUME);\n    vol = Math.min(vol, MAX_VOLUME);\n\n    if (save) {\n      this.currentVolume = vol;\n    }\n\n    if (this.playing) {\n      // a ramp's time spans from the previously scheduled event,\n      // which could be any time, so schedule two for any change.\n      const t = this.glaudio.at();\n      this.gain.gain.setValueAtTime(this.gain.gain.value, t);\n      this.gain.gain.exponentialRampToValueAtTime(vol, t + 0.032);\n    }\n  }\n\n  set (name, value){\n    if (name.toLowerCase() === \"volume\"){\n      this.setVolume(value);\n    }\n    else if (this.node.hasOwnProperty(name)) {\n      this.node[name].value = value;\n    }\n  }\n\n  on () {\n    this.playing = true;\n    this.setVolume(this.currentVolume);\n  }\n\n  off () {\n    this.setVolume(0, false);\n    this.playing = false;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/audio/AudioUnit.js","export const MIN_VOLUME = 0.001;\nexport const MAX_VOLUME = 1.5;\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/Constants.js","import Sprite from \"../../base/sprites/Sprite\";\n\nexport default class Bullet extends Sprite {\n  constructor () {\n    super();\n    this.active = false;\n    this.velocity = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  shoot (position, velocity) {\n    this.active = true;\n    this.position = position;\n    this.velocity = velocity;\n  }\n\n  update () {\n    this.position.x += this.velocity.x;\n    this.position.y += this.velocity.y;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/components/sample/Bullet.js","import GameLoop from \"./gameloop/GameLoop\";\nimport Clear from \"./gameloop/components/Clear\"\nimport StarField from \"./gameloop/components/sample/StarField\";\nimport AnimatedSprite from \"./gameloop/base/sprites/AnimatedSprite\"\nimport Frame from \"./gameloop/base/Frame\";\nimport Sprite from \"./gameloop/base/sprites/Sprite\";\nimport Manager from \"./gameloop/base/Manager\";\nimport RegistryItem from \"./gameloop/base/RegistryItem\";\nimport AudioUnit from \"./gameloop/base/audio/AudioUnit\";\nimport GLAudio from \"./gameloop/base/audio/GLAudio\"\nimport SoundTrack from \"./gameloop/base/audio/SoundTrack\"\nimport Bullet from \"./gameloop/components/sample/Bullet\";\nimport Shooter from \"./gameloop/components/sample/Shooter\";\nimport Keyboard from \"./gameloop/base/input/Keyboard\";\nimport Mouse from \"./gameloop/base/input/Mouse\";\nimport Gamepad from \"./gameloop/base/input/Gamepad\";\nimport Touch from \"./gameloop/base/input/Touch\";\n\nimport logo from \"./logo\";\n\nconsole.log(logo);\n\n/**\n * We currently globalize everything by attaching to window\n *\n * Is there a better way?\n*/\n\n// Globalize classes\nwindow.Clear = Clear;\nwindow.StarField = StarField;\nwindow.AnimatedSprite = AnimatedSprite;\nwindow.Sprite = Sprite;\nwindow.Frame = Frame;\nwindow.RegistryItem = RegistryItem;\nwindow.AudioUnit = AudioUnit;\nwindow.GLAudio = GLAudio;\nwindow.SoundTrack = SoundTrack;\nwindow.Bullet = Bullet;\nwindow.Shooter = Shooter;\n\n// Globalize instances\nwindow.manager = new Manager();\nwindow.GameLoop = new GameLoop();\nwindow.Keyboard = new Keyboard(document);\nwindow.Mouse = new Mouse(document);\nwindow.Gamepad = new Gamepad(navigator, window, console)\nwindow.Touch = new Touch(navigator, window, console)\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop.js","import { GameException } from \"./Exceptions\";\nimport { onReady } from \"./util/OnReady\";\n\n/**\n * GameLoop Class\n *\n * TODO: implement window-visibility loss detection\n * http://stackoverflow.com/a/1060034/1004027\n *\n * @param canvas {string} id of <canvas> element | {HTMLCanvasElement} to draw on.\n * @returns {GameLoop}\n * @constructor\n */\nexport default class GameLoop {\n  constructor (canvas) {\n    this.canvas = canvas;\n    this.ctx = null;\n    this.initialized = false;\n    this.drawContext = null;\n    this.initialized = false;\n    this.initEvents = [];\n    this.prevUpdate = 0;\n    this.prevDraw = 0;\n    this.updateables = [];\n    this.drawables = [];\n    this.targetRate = 33;\n  }\n\n  /**\n   *\n   * @param canvas\n   */\n  initialize (canvas) {\n    //unify browser functions\n    (function(w) {\n      w.requestAnimationFrame = window.requestAnimationFrame ||\n        window.mozRequestAnimationFrame ||\n        window.webkitRequestAnimationFrame ||\n        window.msRequestAnimationFrame ||\n        function(f){ return w.setTimeOut(f, 33);};  // IE9?\n    })(window);\n\n    onReady( () => {\n      if (!canvas) {\n        throw new GameException(\"Missing canvas\");\n      }\n\n      // skip setting if context is already known.\n      if (this.drawContext === null){\n        if (typeof(canvas) === \"string\"){\n          this.canvas = document.getElementById(canvas);\n        }\n        if (this.canvas.getContext){\n          this.ctx = this.canvas.getContext(\"2d\");\n          // Why do we need drawContext?\n          this.drawContext = this.ctx;\n        }\n      }\n\n      window.addEventListener(\"resize\", this._resizeCanvas.bind(this), false);\n      this._resizeCanvas();\n\n      // kick off main loop\n      window.requestAnimationFrame(this._loop.bind(this));\n\n      this.initialized = true;\n      this._fireInitEvents();\n    });\n  }\n\n  /**\n   * Add and item to one or both of the update and draw lists\n   *\n   * @param objectable {Object} with function member \"update\" or \"draw\" or both\n   */\n  addItem (objectable) {\n    if (objectable){\n      if (typeof(objectable.draw) === \"function\"){\n        this.addDrawable(objectable);\n      }\n      if (typeof(objectable.update) === \"function\"){\n        this.addUpdateable(objectable);\n      }\n    }\n  }\n\n  /**\n   * Add an item to the list of items in the update list\n   *\n   * @param updateable {Object} with function member \"update\"\n   * @returns {Number} New count of updateable components\n   * @throws {GameException} if object does not contain \"update\" function\n   */\n  addUpdateable (updateable) {\n    if (updateable && updateable.update && typeof(updateable.update) === \"function\") {\n      this.updateables.push(updateable);\n    } else {\n      throw new GameException(\"invalid updateable object added.\");\n    }\n    //crude identifier, invalidated by each removal\n    return this.updateables.length;\n  }\n\n  /**\n   * Add an item to the list of items in the draw list\n   *\n   * @param drawable {Object} with function member \"draw\"\n   * @returns {Number} New count of drawable components\n   * @throws {GameException} if object does not contain \"draw\" function\n   */\n  addDrawable (drawable) {\n    if (drawable && drawable.draw && typeof(drawable.draw) === \"function\"){\n      this.drawables.push(drawable);\n    } else {\n      throw new GameException(\"Invalid drawable object added.\");\n    }\n    return this.drawables.length;\n  }\n\n  /**\n   *\n   * @param item\n   * @returns {boolean}\n   */\n  remove (item) {\n    this.drawables.forEach((object, i) => {\n      if (object === item){\n        this.drawables.splice(i, 1);\n        return true;\n      }\n    });\n\n    this.updateables.forEach((object, i) => {\n      if (object === item){\n        this.updateables.splice(i, 1);\n        return true;\n      }\n    });\n\n    return false;\n  }\n\n  /**\n   *\n   * @param timestamp\n   * @private\n   */\n  _loop (timestamp) {\n    if (this.initialized){\n      this._update(timestamp);\n      this._draw(timestamp);\n    }\n    requestAnimationFrame(this._loop.bind(this));\n  }\n\n  /**\n   *\n   * @param timestamp\n   * @private\n   */\n  _update(timestamp) {\n    let timeDiff = timestamp - this.prevUpdate;\n    this.prevUpdate = timestamp;\n\n    timeDiff = timeDiff % (2 * this.targetRate);\n\n    this.updateables.forEach((object) => {\n      object.update(this.drawContext, timeDiff, timestamp);\n    });\n  }\n\n  /**\n   *\n   * @param timestamp\n   * @private\n   */\n  _draw (timestamp) {\n    const timeDiff = timestamp - this.prevDraw;\n    this.prevDraw = timestamp;\n    this.drawables.forEach((object) => {\n      if (typeof(this.drawContext.save) === \"function\"){\n        this.drawContext.save();\n      }\n      object.draw(this.drawContext, timeDiff, timestamp);\n      if (typeof(this.drawContext.restore) === \"function\") {\n        this.drawContext.restore();\n      }\n    });\n  }\n\n  /**\n   *\n   * @param f\n   * @private\n   */\n  _onInit (f) {\n    this.initEvents.push(f);\n  }\n\n  /**\n   *\n   * @private\n   */\n  _fireInitEvents () {\n    this.initEvents.forEach((event) => {\n      event.call(this);\n    });\n  }\n\n  _resizeCanvas () {\n    this.canvas.width = window.innerWidth;\n    this.canvas.height = window.innerHeight;\n\n    /**\n     * Your drawings need to be inside this function otherwise they will be reset when\n     * you resize the browser window and the canvas goes will be cleared.\n     */\n    // drawStuff();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/GameLoop.js","export function onReady(cb) {\n  if (document.readyState === \"complete\") {\n    cb(...arguments);\n  } else {\n    const prevORSC = document.onreadystatechange;  //save previous event\n    document.onreadystatechange = function () {\n      if (typeof(prevORSC) === \"function\"){\n        prevORSC();\n      }\n      if (document.readyState === \"complete\") {\n        cb(...arguments);\n      }\n    };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/util/OnReady.js","export default class Clear {\n\n  constructor(color) {\n    this.color = color || null;\n  }\n\n  draw (context) {\n    const width = context.canvas.width;\n    const height = context.canvas.height;\n\n    context.setTransform(1, 0, 0, 1, 0, 0);\n\n    if (this.color === null){\n      context.clearRect(0, 0, width, height);\n    } else {\n      context.save();\n      context.fillStyle = this.color;\n      context.fillRect(0, 0, width, height);\n      context.restore();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/components/Clear.js","export default class StarField {\n\n  constructor() {\n    this.center = {x:0, y:0};\n    this.bounds = {x:0, y:0};\n    this.particles = [];\n    this.particleCount = 200;\n    this.color = \"white\";\n    this.clearing = true;\n    this.spawnRadius = 10;\n  }\n\n  draw (context) {\n\n    if (this.clearing) {\n      context.fillStyle = \"rgba(0, 0, 10, 0.1)\";\n      context.fillRect(0, 0, 2 * this.center.x, 2 * this.center.y);\n    }\n\n    context.fillStyle = this.color;\n\n    this.particles.forEach((particle) => {\n      context.fillRect(\n        particle.x - 1,\n        particle.y - 1,\n        2, 2);\n    });\n  }\n\n  update (context) {\n\n    const bounds = {\n      x: context.canvas.width,\n      y: context.canvas.height\n    };\n\n    const center = {\n      x: bounds.x / 2,\n      y: bounds.y / 2\n    };\n\n    while (this.particles.length < this.particleCount){\n      this.particles.push({\n        x: 2 * this.spawnRadius * Math.random() - this.spawnRadius + center.x,\n        y: 2 * this.spawnRadius * Math.random() - this.spawnRadius + center.y\n      });\n    }\n\n    this.particles.forEach((particle, i) => {\n      particle.x += (particle.x - center.x) * 0.02;\n      particle.y += (particle.y - center.y) * 0.02;\n\n      if (particle.x < 0 ||\n          particle.x > bounds.x ||\n          particle.y < 0 ||\n          particle.y > bounds.y\n      )\n      {\n        this.particles.splice(i, 1);\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/components/sample/StarField.js","import RegistryItem from \"./RegistryItem\";\n\nexport default class Manager {\n\n  constructor () {\n    this.registry = {};\n    this.awaiting = {};\n    this.assets = {};\n    this.components = [];\n  }\n\n  /**\n   * get\n   *\n   * @param key\n   * @returns {*}\n   */\n  get (key) {\n    if (this.registry.hasOwnProperty(key)){\n      return this.registry[key].obj;\n    }\n  }\n\n  /**\n   * add\n   *\n   * @param key\n   * @param obj\n   */\n  add (key, obj) {\n    this.registry[key] = new RegistryItem(key, obj);\n  }\n\n  /**\n   * addAsset\n   *\n   * @param key\n   * @param asset\n   */\n  addAsset (key, asset) {\n    this.assets[key] = asset;\n  }\n\n  /**\n   * getAsset\n   *\n   * @param key\n   * @returns {*}\n   */\n  getAsset (key) {\n    if (this.assets.hasOwnProperty(key)){\n      return this.assets[key];\n    }\n    return null;\n  }\n\n  /**\n   * loadAssets\n   */\n  loadAssets () {\n    const assets = document.querySelectorAll(\"[data-gl-asset]\");\n    assets.forEach((asset) => {\n      this.addAsset(asset.dataset.glAsset, asset);\n    });\n  }\n\n  /**\n   * update\n   *\n   * @param context\n   * @param timediff\n   * @param timestamp\n   */\n  update (context, timediff, timestamp) {\n    this.components.forEach((component) => {\n      component.update(context,timediff, timestamp);\n    });\n  }\n\n  /**\n   * addItem\n   *\n   * @param component\n   */\n  addItem (component) {\n    this.components.push(component);\n  }\n\n  /**\n   * await\n   *\n   * @param key\n   * @param callback\n   * @param context\n   */\n  await (key, callback, context) {\n    if (this.registry.hasOwnProperty(key)){\n      switch (this.registry[key].state){\n        case \"ready\":\n          callback.call(context, this.registry[key].obj);\n          break;\n        default :\n          this.awaiting[key] = {context:context, callback:callback};\n          break;\n      }\n    }\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/Manager.js","/* global manager, GameLoop */\nimport { MIN_VOLUME } from \"../../Constants\";\nimport { GameException } from \"../../Exceptions\";\nimport AudioUnit from \"./AudioUnit\";\n\nexport default class GLAudio {\n\n  constructor () {\n    this.context = new AudioContext();\n    this.master = this.context.createGain();\n    this.sounds = this.context.createGain();\n    this.music = this.context.createGain();\n\n    this.sounds.connect(this.master);\n    this.music.connect(this.master);\n    this.master.connect(this.context.destination);\n  }\n  /**\n   * at\n   *\n   * @param offset\n   * @returns {*}\n   */\n  at (offset) {\n    if (typeof(offset) === \"undefined\") {\n      offset = 0;\n    }\n    return (this.getContext().currentTime + offset);\n  }\n\n  /**\n   * getMasterVolume\n   */\n  getMasterVolume () {\n    return this.master.gain.value;\n  }\n\n  /**\n   * setMasterVolume\n   *\n   * @param vol\n   */\n  setMasterVolume (vol) {\n    vol = Math.max(vol, MIN_VOLUME);\n    vol = Math.min(vol, 1);\n    const t = this.at();\n    this.master.gain.setValueAtTime(this.master.gain.value, t);\n    this.master.gain.exponentialRampToValueAtTime(vol, t + 0.032);\n  }\n\n  /**\n   * getSoundsVolume\n   */\n  getSoundsVolume () {\n    return this.sounds.gain.value;\n  }\n\n  /**\n   * setSoundsVolume\n   *\n   * @param vol\n   */\n  setSoundsVolume (vol) {\n    vol = Math.max(vol, MIN_VOLUME);\n    vol = Math.min(vol, 1);\n    const t = this.at();\n    this.sounds.gain.setValueAtTime(this.sounds.gain.value, t);\n    this.sounds.gain.exponentialRampToValueAtTime(vol, t + 0.032);\n  }\n\n  /**\n   * getMusicVolume\n   */\n  getMusicVolume () {\n    return this.music.gain.value;\n  }\n\n  /**\n   *\n   * @param vol\n   */\n  setMusicVolume (vol) {\n    vol = Math.max(vol, MIN_VOLUME);\n    vol = Math.min(vol, 1);\n    const t = this.at();\n    this.music.gain.setValueAtTime(this.music.gain.value, t);\n    this.music.gain.exponentialRampToValueAtTime(vol, t + 0.032);\n  }\n\n  _makeUnit(type, options, node) {\n    const vol = GameLoop.ctx.createGain();\n    const unit = new AudioUnit(node, vol, type);\n    for (const p in options) {\n      unit.set(p, options[p]);\n    }\n    return unit;\n  }\n\n  create (name, options) {\n    if (typeof(options) === \"undefined\") {\n      options = {};\n    }\n\n    let node = null;\n    let result = null;\n\n    switch (name) {\n      case \"oscillator\":\n        node = this.context.createOscillator();\n        result = this._makeUnit(null, options, node);\n        node.start();\n        break;\n      case \"music\":\n      case \"sound\":\n        if (options.hasOwnProperty(\"media\")){\n          const newMedia = options.media.cloneNode();\n          node = this.context.createMediaElementSource(newMedia);\n          result = this.makeUnit(name, node);\n          result.on = () => {\n            this.playing = true;\n            newMedia.play();\n            this.setVolume(this.currentVolume);\n          };\n          result.off = () => {\n            this.playing = false;\n            newMedia.pause();\n            this.setVolume(0, false);\n          };\n        }\n        else if (options.hasOwnProperty(\"asset\")) {\n          options.media = manager.getAsset(options.asset);\n          result = this.create(name, options);\n        }\n        else if (options.hasOwnProperty(\"data\")) {\n          let node = this.context.createBufferSource();\n          node.buffer = options.data;\n          result = this.makeUnit(name, node);\n          result.progress = 0;\n          result.startTime = 0;\n\n          result.on = () => {\n            if (this.playing) {\n              return;\n            }\n            this.playing = true;\n            node.start(0, this.progress);\n            this.startTime = this.at();\n            this.setVolume(this.currentVolume);\n          };\n\n          const onend = () => {\n            if (result.playing) {\n              result.off();\n              result.progress = 0;\n            }\n          };\n\n          result.off = () => {\n            if (!this.playing) {\n              return;\n            }\n\n            node.stop();\n            this.playing = false;\n            this.progress += (this.at() - this.startTime);\n            this.setVolume(0, false);\n            const newnode = this.context.createBufferSource();\n            newnode.buffer = node.buffer;\n            node = newnode;\n            node.connect(this.gain);\n            node.onended = onend;\n          };\n\n          node.onended = onend;\n        }\n        else {\n          throw new GameException(\"Can't create music instance.\");\n        }\n        break;\n      default:\n        break;\n    }\n    return result;\n  }\n}\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/audio/GLAudio.js","/* global manager */\n\nexport default class SoundTrack {\n  constructor (glaudio) {\n    this.nowPlaying = \"\";\n    this.activeUnit = null;\n    this.glaudio = glaudio;\n  }\n\n  play (name){\n    const item = manager.getAsset(name);\n    if (item) {\n      if (this.activeUnit) {\n        this.activeUnit.off();\n      }\n      const track = this.glaudio.create(\"music\", { media: item });\n      this.nowPlaying = item.title;\n      track.on();\n      this.activeUnit = track;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/audio/SoundTrack.js","import { GameException } from \"../../Exceptions\";\nimport Bullet from \"./Bullet\";\nimport Sprite from \"../../base/sprites/Sprite\";\n\nexport default class Shooter extends Sprite {\n  constructor () {\n    super();\n\n    this.PERIOD = 1000;\n    this.speed = 200;\n    this.width = 0;\n    this.height = 0;\n    this.input = {\n      getX: () => { return 0; },\n      getY: () => { return 0; },\n      isShooting: () => { return false; }\n    };\n    this.shotPeriod = 0.5;\n    this.bulletList = [\n      new Bullet(),\n      new Bullet(),\n      new Bullet()\n    ];\n    this.shotTimer = 0;\n    this.position = {\n      x: 0,\n      y: 0\n    };\n\n    this.bulletList.forEach((bullet) => {\n      bullet.readyLoadImageId(\"ship\");\n    });\n  }\n\n  setInput (input) {\n    if (typeof(input.getX) === \"function\" &&\n        typeof(input.getY) === \"function\" &&\n        typeof(input.isShooting) === \"function\"\n    ) {\n      this.input = input;\n    } else {\n      throw new GameException(\"invalid input module\", input);\n    }\n  }\n\n  update (context, timediff) {\n    if (timediff < -1) {\n      return;\n    }\n    this.updatePosition.call(this, context, timediff);\n    this.updateBullets.call(this, context, timediff);\n  }\n\n  updatePosition (context, timediff) {\n    //change position\n    const speed = this.speed * timediff / this.PERIOD;\n    const v = {\n      x: this.input.getX() * speed,\n      y: this.input.getY() * speed\n    };\n    this.position.x += v.x;\n    this.position.y += v.y;\n\n    //clamp to screen\n    this.position.x = Math.max(this.width / 2, this.position.x);\n    this.position.x = Math.min(this.width / -2 + context.canvas.width, this.position.x);\n    this.position.y = Math.max(this.height / 2, this.position.y);\n    this.position.y = Math.min(this.height / -2 + context.canvas.height, this.position.y);\n  }\n\n  getNextBullet () {\n    this.bulletList.forEach((bullet) => {\n      if (!bullet.isActive()) {\n        return bullet;\n      }\n    });\n    return null;\n  }\n\n  updateBullets (context, timediff){\n    if (this.input.isShooting()) {\n      if (this.shotTimer > 0) {\n        this.shotTimer -= (timediff / this.PERIOD);\n      }\n      else {\n        const next = this.getNextBullet();\n        if (next !== null) {\n          next.shoot(this.position, { x: 1, y: 0 });\n          this.shotTimer = this.shotPeriod();\n        }\n      }\n    }\n\n    this.bulletList.forEach((bullet) => {\n      if (bullet.isActive()) {\n        bullet.update(timediff);\n      }\n    });\n  }\n\n  draw (context, timediff, timestamp) {\n    super.draw(context, timediff, timestamp);\n\n    this.bulletList.forEach((bullet) => {\n      if (bullet.isActive()) {\n        bullet.draw(context, timediff, timestamp);\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/components/sample/Shooter.js","/*\n level 1 - basic wrappers around raw inputs.\n For keyboard, current depressed keys.  For mouse, current position within viewport.\n For gamepad, sticks as vectors and button states.  Singletons.\n\n level 2 - Unifying abstractions and functions of basic input.  Customization\n settings such as key bindings.  Instances per player.\n\n level 3 - translation to game input.  Take values from level2 and wrap them\n in an API appropriate to the game being played.\n\n */\n\n//Level 1\n\nexport default class Keyboard {\n  constructor (receiver) {\n    this.receiver = receiver;\n\n    this.keys = {};\n    this.keyProperty = \"key\";\n    this.isPushed = this.isKeyDown;\n\n    function keyEventAnalyze (e) {\n      const backups = [\"key\", \"which\", \"keyCode\"];\n      while(!e.hasOwnProperty(this.keyProperty)){\n        this.keyProperty = backups.shift();\n        if (backups.length === 0) {\n          // TODO: figure out what to do about this situation.\n          break;\n        }\n      }\n      this.receiver.removeEventListener(\"keydown\", keyEventAnalyze);\n    }\n\n    this.receiver.addEventListener(\"keydown\", keyEventAnalyze);\n    this.receiver.addEventListener(\"keydown\", (e) => {\n      this.keys[e[this.keyProperty]] = true;\n    });\n    this.receiver.addEventListener(\"keyup\", (e) => {\n      this.keys[e[this.keyProperty]] = false;\n    });\n  }\n\n  isKeyDown (value) {\n    return (this.keys[value]);\n  }\n\n  anyKey () {\n    this.keys.forEach((key) => { if (this.keys[key]){ return true; } })\n  };\n}\n\nfunction UIRegion(x, y, w, h){\n    this.x = x;\n    this.y = y;\n    this.w = w;\n    this.h = h;\n};\nUIRegion.prototype.contains = function(o){\n    return (\n    (o.x > this.x) && (o.x < (this.x + this.w)) &&\n    (o.y > this.y) && (o.y < (this.y + this.h))\n    );\n};\nUIRegion.prototype.center = function(){\n    return {x: this.x + this.w / 2, y: this.y + this.h / 2}\n};\n\nvar Input = function(){\n    var _inputs = {\n        mouse : GLInput.mouse,\n        keyboard : GLInput.keyboard,\n        gamepad : GLInput.gamepad,\n        touch : GLInput.touch\n    };\n\n    var axes = {};\n    var buttons = {};\n    var prevButtons = {};\n    var currButtons = {};\n\n    var UIList = {};\n    var currUI = {};\n    var prevUI = {};\n\n    this.getPointer = function(){\n        return _inputs.mouse;\n    };\n\n    this.setUI = function(id, region, buttons){\n        if (!buttons){ buttons = []; }\n\n        // validate region object\n        if (typeof region.contains != \"function\"){\n            throw (\"invalid\");\n        }\n        UIList[id] = {region: region, buttons: buttons};\n    };\n    this.removeUI = function(id){\n        delete UIList[id];\n        delete currUI[id];\n        delete prevUI[id];\n    };\n\n    this.setAxisId = function(id, type, typeid, typeid2){\n        if (!_inputs.hasOwnProperty(type)) return;\n        axes[id] = {type: type, id: typeid, id2: typeid2};\n    };\n    this.setButtonId = function(id, type, typeid){\n        if (!_inputs.hasOwnProperty(type)) return;\n        buttons[id] = {type: type, id: typeid};\n    };\n\n    this.getAxis = function(id, frompos){\n        var val = 0;\n        var type = axes[id].type;\n        switch (type){\n            case ('mouse'):\n            case ('touch'):\n                if (_inputs[type].isTracking(axes[id].id)){\n                    var dir = _inputs[type].getPosition(axes[id].id);\n                    var coord = axes[id].id;\n                    var other = (coord == 'x') ? 'y' : 'x';\n                    var unnormal = dir[coord] - frompos[coord];\n                    var unsign = (unnormal < 0) ? -1 : 1;\n                    var otherUnnormal = dir[other] - frompos[other];\n                    var othersign = (otherUnnormal < 0) ? -1 : 1;\n                    val = unsign * Math.sqrt(unnormal * unnormal /\n                        (unnormal * unnormal + otherUnnormal * otherUnnormal));\n                }\n                break;\n            case ('keyboard'):\n                var keyPos = axes[id].id;\n                var keyNeg = axes[id].id2;\n                if (_inputs.keyboard.isKeyDown(keyNeg)){\n                    val -= 1;\n                }\n                if (_inputs.keyboard.isKeyDown(keyPos)){\n                    val += 1;\n                }\n                break;\n            case ('gamepad'):\n                val = _inputs.gamepad.getAxis(axes[id].id);\n                break;\n        }\n        return val;\n    };\n    this.isButtonDown = function(id){\n        return (currButtons.hasOwnProperty(id) && currButtons[id]);\n    };\n    this.newButtonPush = function(id){\n        return (\n            currButtons.hasOwnProperty(id)\n            && currButtons[id]\n            && !prevButtons[id]\n        );\n    };\n\n    this.isUIOver = function(id){\n        return (currUI.hasOwnProperty(id) && currUI[id]);\n    };\n\n    this.isUIPush = function(id){\n\n        // default false\n        var result = false;\n        // check that the element is being interacted with, and that the element has buttons\n        if (currUI.hasOwnProperty(id) && UIList[id].buttons.length ){\n            // iterate the element's buttons\n            for (var b = 0; b < UIList[id].buttons.length; ++b){\n                if (this.isButtonDown(UIList[id].buttons[b])){\n                    // keyboard and gamepad are button-only,\n                    // mouse and touch also require position\n                    var type = buttons[UIList[id].buttons[b]].type;\n                    if (type == 'keyboard' || type == 'gamepad' ){\n                        result = true;\n                    } else if (type == 'mouse' || type == 'touch'){\n                        result = this.isUIOver(id);\n                    }\n                    // stop iterating for any success\n                    if (result) { break; }\n                }\n            }\n        }\n\n        return result;\n    };\n\n\n    this.anyPress = function(){\n        return _inputs.keyboard.anyKey() ||\n            _inputs.gamepad.anyButton() ||\n            _inputs.mouse.anyButton() ||\n            _inputs.touch.anyTouch();\n    };\n    this.has = function(type){\n        switch (type){\n            case 'keyboard':\n                return true;\n            case 'mouse':\n                return true;\n            case 'touch':\n                return _inputs.touch.exists();\n            case 'gamepad':\n                return _inputs.gamepad.exists();\n            default:\n                return false;\n        }\n    };\n    var getButtons = function(){\n\n        for (var butt in buttons){\n            prevButtons[butt] = currButtons[butt];\n            currButtons[butt] = _inputs[buttons[butt].type].isPushed(buttons[butt].id);\n        }\n    };\n    var getUI = function(){\n        for (var id in UIList){\n            prevUI[id] = currUI[id];\n            currUI[id] = (\n                _inputs['mouse'].getIsWithinUI(UIList[id].region)\n                || _inputs['touch'].getIsWithinUI(UIList[id].region)\n            );\n        }\n    };\n\n    this.update = function(context, timediff, timestamp){\n        if (!_inputs.mouse.hasViewport()){\n            _inputs.mouse.setViewPort(context.canvas);\n        }\n        if (!_inputs.touch.hasViewport()){\n            _inputs.touch.setViewPort(context.canvas);\n        }\n        getButtons();\n        getUI();\n    };\n\n\n\n};\n\n\n/**\n * Tier 3: input objects used by games.\n * I am attempting to use GameInput as a prototype for some examples.\n */\nvar GameInput = function(){\n    this.input = new Input();\n    this.getInput = function(){ return this.input; };\n};\nGameInput.prototype.update = function(context, timediff, timestamp){\n    this.getInput().update(context, timediff, timestamp);\n};\nGameInput.prototype.anyPress = function(){\n    return this.getInput().anyPress();\n};\nGameInput.prototype.getPointer = function(){\n    return this.getInput().getPointer().getPosition();\n};\n\n// placeholder\nvar nullInput = function() {\n    this.getX = function() {\n        return 0;\n    };\n    this.getY = function() {\n        return 0;\n    };\n    this.isShooting = function(){\n        return false;\n    };\n    this.update = function(context, timediff, timestamp){\n        return;\n    };\n}\n\n\nvar MenuInput = function(){\n    var menuMoveTime = 0;\n    this.canMove = function (timediff){\n        menuMoveTime -= timediff;\n        menuMoveTime = Math.max(menuMoveTime, 0);\n        return (menuMoveTime <= 0);\n    };\n    this.menuMove = function(time){\n        menuMoveTime += time;\n    };\n    this.menuThreshold = 0.75;\n    this.menuDelay = 300;\n\n    this._up = false;\n    this._down = false;\n    this._select = false;\n\n    this.getInput().setAxisId('menuupdown', 'keyboard', 40, 38);\n    this.getInput().setAxisId('menuupdown2', 'gamepad', 1);\n    this.getInput().setAxisId('menuupdown3', 'gamepad', 3);\n    this.getInput().setAxisId('menuupdown4', 'gamepad', 5);\n\n    this.getInput().setButtonId('menuselect1', 'keyboard', 13);\n    this.getInput().setButtonId('menuselect2', 'keyboard', 32);\n    this.getInput().setButtonId('menuselect3', 'gamepad', 0);\n    this.getInput().setButtonId('menuclick', 'mouse', 1);\n\n    this.getInput().setButtonId('menuback1', 'keyboard', 27);\n    this.getInput().setButtonId('menuback2', 'gamepad', 1);\n\n};\nMenuInput.prototype = new GameInput();\nMenuInput.constructor = MenuInput;\n\nMenuInput.prototype.update = function(context, timediff, timestamp){\n    GameInput.prototype.update.call(this, context, timediff, timestamp);\n    this.menuUpdate(timediff);\n};\nMenuInput.prototype.menuUpdate = function(timediff){\n\n    if (!this.canMove(timediff)){\n        this._down = false;\n        this._up = false;\n        this._select = false;\n        return;\n    }\n    if (this.getInput().newButtonPush('menuselect1') ||\n        this.getInput().newButtonPush('menuselect2') ||\n        this.getInput().newButtonPush('menuselect3')\n    ){\n        this.menuMove(this.menuDelay);\n        this._select = true;\n    } else {\n        this._select = false;\n    }\n    var menuupdown =\n        this.getInput().getAxis('menuupdown') +\n        this.getInput().getAxis('menuupdown2') +\n        this.getInput().getAxis('menuupdown3') +\n        this.getInput().getAxis('menuupdown4');\n\n    if (menuupdown >= this.menuThreshold){\n        this._down = true;\n        this.menuMove(this.menuDelay);\n    } else {\n        this._down = false;\n    }\n    if (menuupdown <= (-1 * this.menuThreshold)){\n        this._up = true;\n        this.menuMove(this.menuDelay);\n    } else {\n        this._up = false;\n    }\n};\nMenuInput.prototype.menuDown = function(){\n    return this._down;\n};\nMenuInput.prototype.menuUp = function(){\n    return this._up;\n};\nMenuInput.prototype.menuSelect = function(){\n    return this._select;\n};\nMenuInput.prototype.menuClick = function(){\n    return this.getInput().newButtonPush('menuclick');\n};\nMenuInput.prototype.menuBack = function(){\n    return this.getInput().newButtonPush('menuback1') ||\n        this.getInput().newButtonPush('menuback2');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/input/Keyboard.js","export default class Mouse {\n\n  constructor (receiver) {\n    this.receiver = receiver;\n\n    // if canvas size mismatches css/event size\n    this.vp_pixel_ratio_x = 1;\n    this.vp_pixel_ratio_y = 1;\n\n    this.viewport = null;\n    this.position = {x: -1, y: -1};\n    this.tracking = false;\n    this.buttons = {};\n\n    this.receiver.addEventListener(\"mouseup\", this.up);\n    this.receiver.addEventListener(\"mousedown\", this.down);\n\n    // browser compatibility section\n    function mouseAnalyze(e){\n      if (!(\"offsetX\" in e)) {\n        this.getOffset = function (e) {\n          const bcr = e.target.getBoundingClientRect();\n          return {\n            x: this.vp_pixel_ratio_x * (e.clientX - bcr.left),\n            y: this.vp_pixel_ratio_y * (e.clientY - bcr.top)\n          };\n        };\n      }\n      this.receiver.removeEventListener(\"mousemove\", mouseAnalyze);\n    }\n    this.receiver.addEventListener(\"mousemove\", mouseAnalyze);\n  }\n\n  getOffset (e) {\n    return {\n      x: this.vp_pixel_ratio_x * e.offsetX,\n      y: this.vp_pixel_ratio_y * e.offsetY\n    };\n  }\n\n  getIsWithinUI (region) {\n    return this.tracking && region.contains(this.position);\n  }\n\n  over () {\n    this.tracking = true;\n  }\n\n  out () {\n    this.tracking = false;\n    this.position = {\n      x: -1,\n      y: -1\n    };\n  }\n\n  move (e) {\n    if (this.tracking) {\n      this.position = this.getOffset(e);\n    }\n  }\n\n  down (e) {\n    if (this.tracking) {\n      this.buttons[e.which] = true;\n    }\n  }\n\n  up (e) {\n    this.buttons[e.which] = false;\n  }\n\n  click (e){\n    // TODO\n  }\n\n  wireEvents () {\n    if (this.viewport !== null) {\n      this.viewport.addEventListener(\"click\", this.click);\n      this.viewport.addEventListener(\"mouseover\", this.over);\n      this.viewport.addEventListener(\"mouseout\", this.out);\n      this.viewport.addEventListener(\"mousemove\", this.move);\n    }\n  }\n\n  unwireEvents () {\n    if (this.viewport !== null){\n      this.viewport.removeEventListener(\"click\", this.click);\n      this.viewport.removeEventListener(\"mouseover\", this.over);\n      this.viewport.removeEventListener(\"mouseout\", this.out);\n      this.viewport.removeEventListener(\"mousemove\", this.move);\n    }\n  }\n\n  setViewPort (canvas) {\n    this.unwireEvents();\n    this.viewport = canvas;\n    this.vp_pixel_ratio_x = canvas.width / canvas.clientWidth;\n    this.vp_pixel_ratio_y = canvas.height / canvas.clientHeight;\n    this.wireEvents();\n  }\n\n  hasViewport () {\n    return (this.viewport !== null);\n  }\n\n  isPushed (id) {\n    return ((id in this.buttons) && this.buttons[id]);\n  }\n\n  anyButton () {\n    this.buttons.forEach((button) => {\n      if (button){\n        return true;\n      }\n    });\n    return false;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/gameloop/base/input/Mouse.js","/**\n * http://www.network-science.de/ascii/\n *\n * Gothic\n */\n\nconst logo = `\n                             .__                        \n   _________    _____   ____ |  |   ____   ____ ______  \n  / ___\\\\__  \\\\  /     \\\\_/ __ \\\\|  |  /  _ \\\\ /  _ \\\\\\\\____ \\\\ \n / /_/  > __ \\\\|  Y Y  \\\\  ___/|  |_(  <_> |  <_> )  |_> >\n \\\\___  (____  /__|_|  /\\\\___  >____/\\\\____/ \\\\____/|   __/ \n/_____/     \\\\/      \\\\/     \\\\/                   |__|\\n`;\n\nexport default logo;\n\n\n\n// WEBPACK FOOTER //\n// ./src/logo.js"],"sourceRoot":""}